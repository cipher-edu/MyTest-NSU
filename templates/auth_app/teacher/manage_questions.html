<!-- templates/auth_app/teacher/manage_questions.html -->
{% extends 'auth_app/base.html' %}
{% block title %}Savollarni boshqarish: {{ test.title }}{% endblock %}

{% block content %}
<div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
    <div>
        <h1 class="text-2xl font-bold">Savollarni boshqarish</h1>
        <h2 class="text-base text-slate-500">{{ test.title }}</h2>
    </div>
    <a href="{% url 'teacher_test_list' %}" class="btn-secondary">Orqaga</a>
</div>

<!-- Yangi savol qo'shish formasi -->
<div class="survey-card mb-8 p-6">
    <h3 class="text-lg font-semibold mb-4">Yangi Savol Qo'shish</h3>
    <form method="post" enctype="multipart/form-data" class="space-y-4">
        {% csrf_token %}
        {{ formset.management_form }}
        <div>
            <label class="block font-medium mb-1">{{ question_form.text.label }}</label>
            {{ question_form.text|add_class:'form-input' }}
        </div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div>
                <label class="block font-medium mb-1">{{ question_form.question_type.label }}</label>
                {{ question_form.question_type|add_class:'form-input' }}
            </div>
            <div>
                <label class="block font-medium mb-1">{{ question_form.points.label }}</label>
                {{ question_form.points|add_class:'form-input' }}
            </div>
            <div>
                <label class="block font-medium mb-1">{{ question_form.image.label }}</label>
                {{ question_form.image|add_class:'form-input' }}
            </div>
        </div>
        <hr class="my-4">
        <h5 class="font-semibold mb-2">Javob Variantlari</h5>
        <div class="space-y-2">
            {% for form in formset %}
            <div class="flex items-center gap-3">
                <div class="flex-1">{{ form.text|add_class:'form-input' }}</div>
                <div class="flex items-center gap-1">
                    {{ form.is_correct }}
                    <label for="{{ form.is_correct.id_for_label }}" class="ml-1 text-sm">To'g'ri</label>
                </div>
            </div>
            {% endfor %}
        </div>
        <button type="submit" class="btn-primary mt-4">Savolni Saqlash</button>
    </form>
</div>

<!-- Mavjud savollar ro'yxati -->
<div class="mt-8">
    <h3 class="text-lg font-semibold mb-4">Mavjud Savollar ({{ questions.count }} ta)</h3>
    {% for question in questions %}
        {% include 'auth_app/partials/_question_card.html' with question=question %}
    {% empty %}
    <div class="bg-primary-50 border-l-4 border-primary-500 text-primary-700 rounded-xl p-4 text-center">
        Bu testda hali savollar mavjud emas. Yuqoridagi formadan yangi savol qo'shing.
    </div>
    {% endfor %}
</div>
{% endblock %}